@page "/test"
@inject IJSRuntime JS;
@inject HttpClient Http

<Button OnClick="LoadAsync"> Start</Button>

<div class="tinder">
    <div class="tinder--status">
        <i class="fa fa-remove"></i>
        <i class="fa fa-heart"></i>
    </div>

    <div class="tinder--cards">
        @if (dataSet == null)
        {
            <Card Loading="dataSet == null ? true : false" Style="width: 300px; margin-top: 16px">
                <CardMeta Avatar="https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png"
                          Title="Card title"
                          Description="This is the description" />
            </Card>

        }
        else
        {
            @for (int i = 0; i < 5; i++)
            {
                <div class="tinder--card">
                    <img src="@dataSet[i].Image_url">
                    <h3>@dataSet[i].Title</h3>
                    <p>@dataSet[i].Description</p>
                </div>
            }
@*            @foreach (var show in dataSet)
            {
                <div class="tinder--card">
                    <img src="@show.Image_url">
                    <h3>@show.Title</h3>
                    <p>@show.Description</p>
                </div>
            }*@
        }

    </div>

    <div class="tinder--buttons">
        <button id="nope"><i class="fa fa-remove"></i></button>
        <button id="love"><i class="fa fa-heart"></i></button>
    </div>
</div>

<style>
    *, *:before, *:after {
        box-sizing: border-box;
        padding: 0;
        margin: 0;
    }

    body {
        background: #CCFBFE;
        overflow: hidden;
        font-family: sans-serif;
    }

    .tinder {
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        position: relative;
        opacity: 0;
        transition: opacity 0.1s ease-in-out;
    }

    .loaded.tinder {
        opacity: 1;
    }

    .tinder--status {
        position: absolute;
        top: 50%;
        margin-top: -30px;
        z-index: 2;
        width: 100%;
        text-align: center;
        pointer-events: none;
    }

        .tinder--status i {
            font-size: 100px;
            opacity: 0;
            transform: scale(0.3);
            transition: all 0.2s ease-in-out;
            position: absolute;
            width: 100px;
            margin-left: -50px;
        }

    .tinder_love .fa-heart {
        opacity: 0.7;
        transform: scale(1);
    }

    .tinder_nope .fa-remove {
        opacity: 0.7;
        transform: scale(1);
    }

    .tinder--cards {
        flex-grow: 1;
        padding-top: 40px;
        text-align: center;
        display: flex;
        justify-content: center;
        align-items: flex-end;
        z-index: 1;
    }

    .tinder--card {
        display: inline-block;
        width: 90vw;
        max-width: 400px;
        height: 70vh;
        background: #FFFFFF;
        padding-bottom: 40px;
        border-radius: 8px;
        overflow: hidden;
        position: absolute;
        will-change: transform;
        transition: all 0.3s ease-in-out;
        cursor: -webkit-grab;
        cursor: -moz-grab;
        cursor: grab;
    }

    .moving.tinder--card {
        transition: none;
        cursor: -webkit-grabbing;
        cursor: -moz-grabbing;
        cursor: grabbing;
    }

    .tinder--card img {
        max-width: 100%;
        pointer-events: none;
    }

    .tinder--card h3 {
        margin-top: 32px;
        font-size: 32px;
        padding: 0 16px;
        pointer-events: none;
    }

    .tinder--card p {
        margin-top: 24px;
        font-size: 20px;
        padding: 0 16px;
        pointer-events: none;
    }

    .tinder--buttons {
        flex: 0 0 100px;
        text-align: center;
        padding-top: 20px;
    }

        .tinder--buttons button {
            border-radius: 50%;
            line-height: 60px;
            width: 60px;
            border: 0;
            background: #FFFFFF;
            display: inline-block;
            margin: 0 8px;
        }

            .tinder--buttons button:focus {
                outline: 0;
            }

        .tinder--buttons i {
            font-size: 32px;
            vertical-align: middle;
        }

    .fa-heart {
        color: #FFACE4;
    }

    .fa-remove {
        color: #CDD6DD;
    }
</style>
@code {
    private ShowDTO[] dataSet;

    protected override Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            return JS.InvokeVoidAsync("initCards").AsTask(); //Gets the cards
        }
            JS.InvokeVoidAsync("initCards"); //Sorts the cards in order
        return Task.CompletedTask;
    }
    protected override async Task OnInitializedAsync()
    {
        dataSet = await Http.GetFromJsonAsync<ShowDTO[]>("https://localhost:5021/topmovie");

    }

    async Task LoadAsync()
    {
        await JS.InvokeVoidAsync("initCards");
    }

}
